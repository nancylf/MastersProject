---
title: "Incubation Data Compilation"
author: "Nancy Freitas"
date: "February 12, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

## Description

This document will be used to compile data that pertains to the NSF Goldstream and NGEE Arctic projects. Lake sediment samples were incubated under different oxygen conditions (aerobic and anaerobic), and at different temperatures (4C, 10C, and 20C) for one year. Gas samples were collected from jars at various time points, and were run on a gas chromatograph (GC) to determine methane (CH~4~) and carbon dioxide (CO~2~) emissions.

Emission data will be organized into data frames, tidied, and scaled into CH~4~ and CO~2~ respiration per unit time. Data will be visualized by depth and type of gas released from the sediment.


#### Motivation

#### Description of Analyses

#### Required Data

1. Concentrations of CO~2~ and CH~4~ by time point (GC raw data) 
2. Sediment characterization - total carbon, total organic carbon by sample depth (compiled by Josefine Lenz)  

```{r}

# THINGS THAT STILL NEED TO BE DONE

# 1) Update particle density values based on 1) the calculations in the paper that Whendee Silver sent me, and 2) the TOC values that come back with the 13C analysis of my specific sediments by depth 
# 2) Create columns in inc_df2 for: respiration rates that are normalized by different time steps (e.g. one slope value for all datapoints within a month)?

```


#### Data Analysis 

Load Packages
```{r, message=FALSE}
# set of packages for everyday data analyses - ggplot2, dplyr, tidyr, readr, purrr, tibble, stringr, forcats
library(tidyverse)

# provides summary statistics about variables, main focus is on data frames
library(skimr)

# imports Excel files into R as .xls or .xlsx
library(readxl)

# makes it possible to use select functions in tidyverse (e.g. "starts_with")
library(tidyselect)

# makes it possible to use function data.table to subset josi's dataframe
library(data.table)

# makes it possible to use function match.closest to subset josi's dataframe
library(MALDIquant)

# color palettes for ggplot2 associated with RColorBrewer package
library(RColorBrewer)

# allows highlighting of selected data in graphs
library(gghighlight)
```

Import data

1. Import the compiled GC data from a large Excel file. This can be done by sheet name:
  * Anaerobic CO2 by time point: "ANA CO2 Compiled"
  * Anaerobic CH4 by time point: "ANA CH4 Compiled"
  * Aerobic CO2 by time point: "AER CO2 Compiled"
  * Aerobic CH4 by time point: "AER CH4 Compiled"
  
  These data will be used to create visualizations of CO~2~ and CH~4~ respiration at different soil depths and oxygen conditions (gC respired/hr/gC in sediment)
  
2. Import Josi's sediment data from a separate Excel file. This can be done by sheet name:
  * Surface core (Vibracore) sediment data: "GSL18-VC11"
  * Deep core (Borehole) sediment data: "GSL18-DC-BH1"
  
  Josi's data will be used to extract bulk density and %C. These values will be combined with my GC data to calculate CO~2~ and CH~4~ respiration:
  * Bulk density (BD)
  * Percent carbon (%C)
  * Percent nitrogen (%N)
  
3. Notes
  * This process is easy to do directly from Excel sheets because they are updated frequently
  * It is faster to work directly from Excel than .csv files
  * Importing the .csv files results in many empty columns where the original Excel sheets were worked on, whereas importing the Excel files does not do this
  
```{r}
# read in Excel files that contain raw CO2 and CH4 ppmv data: read_excel(excel file, sheet name or number)

ngee_nsf_compiled_data <- "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Flux Data/NGEE NSF Incubations_Compiled Data.xlsx"

ana_co2_raw <- read_excel(ngee_nsf_compiled_data, "ANA CO2 Compiled")
ana_ch4_raw <- read_excel(ngee_nsf_compiled_data, "ANA CH4 Compiled")
aer_co2_raw <- read_excel(ngee_nsf_compiled_data, "AER CO2 Compiled")
aer_ch4_raw <- read_excel(ngee_nsf_compiled_data, "AER CH4 Compiled")


# read in Josi's data from Excel files - cell row ranges were used because her Excel sheets contain written notes at the bottom

josi_data <- "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Josi's Data/GSL18_sediment data_all.xlsx"

vc_sed_data <- read_excel(josi_data, "GSL18-VC11", range = cell_rows(1:66))
bh_sed_data <- read_excel(josi_data, "GSL18-DC-BH1", range = cell_rows(1:86))

```


4. Clean up the formatting of the raw data
  * Reshape GC data so that it is long not wide
    * Three columns: sample ID, timepoint, ghg concentration
  * Split sample IDs into depths and replicates
  * Join anaerobic dataframes into one, and aerobic dataframes into one
  * Rename each depth ID so that single digits are preceded by a "0"
  
```{r}
# each column name is a variable, the data in the rows are observations
# take each df, pipe it into gather to collect the column names and name them as time variables, collect the data within the rows (column 2 : the total number of columns) and name them as observations, and then assign them to a new df

ana_co2 <- gather(ana_co2_raw, "timepoint", conc_ppmv, 2:ncol(ana_co2_raw))
ana_ch4 <- gather(ana_ch4_raw, "timepoint", conc_ppmv, 2:ncol(ana_ch4_raw))
aer_co2 <- gather(aer_co2_raw, "timepoint", conc_ppmv, 2:ncol(aer_co2_raw))
aer_ch4 <- gather(aer_ch4_raw, "timepoint", conc_ppmv, 2:ncol(aer_ch4_raw))


# write a function that separates: 1) sample ID into depth ID and replicate # ; and 2) timepoint into gas and timepoint. This will make it easier to combine both ana dfs into one, and both aer dfs into one, and to group by depth and replicate for future analysis across columns

split_cols <- function(df, is_ana){
  df <- df %>% 
    mutate(sample_ID = Sample) %>% 
    select(sample_ID, everything())
  df <- separate(df, Sample, c("depth_ID", "replicate"), sep = "_" ) 
  df <- separate(df, timepoint, c("gas_sampled", "timepoint"), sep = "_T")
  if(is_ana){
   df$depth_ID <- sub("A", "", df$depth_ID)
  }
  return(df)
}

ana_co2 <- split_cols(ana_co2, TRUE)
ana_ch4 <- split_cols(ana_ch4, TRUE)
aer_co2 <- split_cols(aer_co2, FALSE)
aer_ch4 <- split_cols(aer_ch4, FALSE)

# join ana dfs and aer dfs
ana_df <- full_join(ana_co2, ana_ch4)
aer_df <- full_join(aer_co2, aer_ch4)

# label the single digit depth IDs with a leading "0" so that they sort well with the 10, 11, 12 values
for (i in ana_df$depth_ID){
  if(nchar(i) == 1){
    ana_df$depth_ID[ana_df$depth_ID == i] <- paste("0", substring(i, 1), sep = "")
  }
}

for (i in aer_df$depth_ID){
  if(nchar(i) == 1){
    aer_df$depth_ID[aer_df$depth_ID == i] <- paste("0", substring(i, 1), sep = "")
  }
}

```


5. Join categorical data from other Excel sheets for each sampling depth
  * Read in core depth data from Excel - this includes the core segment names and depths (in cm) that samples were taken from down the original sediment cores
  * Join these data to the anaerobic and aerobic dataframes (ana_df and aer_df) - this will allow me to add Josi's data to the table by core depth
  * Sort the dfs by gas, depth_ID, then replicate so that timepoint data stacks for each replicate, and then arrange the dfs by gas with CO~2~ at the top and CH~4~ at the bottom
  * Read in sampling dates from Excel and join to ana_df and aer_df
  * Create one large df with anaerobic and aerobic data
  
```{r}
# read in Excel sheet that contains core depths that pertain to the sample IDs (depth ID and replicate #) - these will be used to add Josi's data into my dfs
sample_key_data <- "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Flux Data/Incubation Sample Key and Dates.xlsx"

core_depths <- read_excel(sample_key_data, "Core Depths and IDs - VC and DC")


# split Sample Depth column into two columns called sample depth lower (cm) and sample depth upper (cm); rename Depth ID and Core ID columns
core_depths <- core_depths %>%
  separate("Sample Depth (cm)", 
           c("sample_depth_lower_cm", "sample_depth_upper_cm"), sep = "-" ) %>%
  rename(depth_ID = "Depth ID", core_ID = "Core ID")


# convert depth_ID column to character values and add a "0" preceeding the single digit depths so that this df can be joined more easily with ana_df and aer_df - values are currently stored as characters
core_depths <- core_depths %>% 
  mutate(depth_ID = as.character(depth_ID))

for (i in core_depths$depth_ID){
  if(nchar(i) == 1){
    core_depths$depth_ID[core_depths$depth_ID == i] <- paste("0", substring(i, 1), sep = "")
  }
}


# join ana_df and aer_df to core_depths using a left join - this is so that the core_depths categorical data logically preceeds the ana_df and aer_df data
ana_df <- left_join(core_depths, ana_df, by = "depth_ID")
aer_df <- left_join(core_depths, aer_df, by = "depth_ID")


# order the dfs by gas, depth_ID, then replicate so that timepoint data stacks for each replicate (i.e. T0-T20 will be visible for 1_1, then 1_2, etc.) 
# order requires a "," after the subset column to indicate that the function should pick up the rest of the columns too
# use arrange to sort CO2 to the top and CH4 to the bottom - this is mostly for aesthetics
ana_df <- ana_df[order(ana_df$gas_sampled, ana_df$depth_ID, ana_df$replicate),] %>%
  arrange(desc(gas_sampled))
aer_df <- aer_df[order(aer_df$gas_sampled, aer_df$depth_ID, aer_df$replicate),] %>%
  arrange(desc(gas_sampled))


# read in Excel sheet that contains sampling dates and days
sampling_dates <- read_excel(sample_key_data, "Sampling Dates - VC and DC")


# select the columns that pertain to anaerobic and aerobic samples, rename, and store them as their own dfs
ana_sampling_dates <- select(sampling_dates, 
                             timepoint = "Timepoint", 
                             samp_int_day = "ANA Sampling Interval (days)",
                             samp_int_date = "ANA Sampling Date")
aer_sampling_dates <- select(sampling_dates, 
                             timepoint = "Timepoint", 
                             samp_int_day = "AER Sampling Interval (days)",
                             samp_int_date = "AER Sampling Date")


# remove the Ts that precede the timepoints in each df
for (i in ana_sampling_dates$timepoint){
  ana_sampling_dates$timepoint[ana_sampling_dates$timepoint == i] <- paste(substring(i, 2), sep = "")
}

for (i in aer_sampling_dates$timepoint){
  aer_sampling_dates$timepoint[aer_sampling_dates$timepoint == i] <- paste(substring(i, 2), sep = "")
}

# join sampling dates dfs to ana_df and aer_df
ana_df <- left_join(ana_df, ana_sampling_dates)
aer_df <- left_join(aer_df, aer_sampling_dates)


# add a column that distinguishes anaerobic and aerobic samples, and convert conc_ppmv columns to numeric values so that the dfs can be joined more easily - one df's columns are currently stored as characters
ana_df <- ana_df %>%
  add_column(headspace_treatment = "anaerobic", .after = "core_ID") %>%
  mutate(conc_ppmv = as.numeric(conc_ppmv))
aer_df <- aer_df %>% 
  add_column(headspace_treatment = "aerobic", .after = "core_ID") %>%
  mutate(conc_ppmv = as.numeric(conc_ppmv))

# join ana_df and aer_df into one large incubation df
inc_df <- full_join(ana_df, aer_df)

```


6. Finish adding columns with categorical data
  * Add an incubation temperature column
  * Add a particle density column
  * Rearrange columns for easier viewing
  
```{r}
# add a temperatures column by replicate # - replicates 1-3 = 4C, replicates 4-6 = 10C, replicates 7-9 = 20C
inc_df <- add_column(inc_df, temp_treatment_C = 0, .after = "headspace_treatment")
inc_df$temp_treatment_C <- ifelse(inc_df$replicate <= 3, 4, ifelse(inc_df$replicate >= 4 & inc_df$replicate <= 6, 10, 20))

# add an hours column - hours will be approximated based on the number of days that elapsed between sampling timepoints. These values can be made more precise by accounting for the individual jar and the exact number of hours that elapsed between timepoints, but it will take some work in Excel. Do this later if it seems necessary.
inc_df <- inc_df %>% mutate(samp_int_hr = samp_int_day * 24)

#rearrange columns, don't use select because it has to be used multiple times - pick up all rows, then arrange columns
inc_df <- inc_df[, c(3, 1:2, 4:5, 7, 6, 8, 13:12, 14, 10:9, 11)]

```

7. Add calculation columns to calculate respiration rates
  * First, the total volume of air in the headspace of each jar needs to be determined
    * Total volume air = volume jar - volume soil - volume soil water
    * Volume of soil will be calculated based on estimated particle density (Dp or dp) values from the literature - this will be used in place of the bulk density values collected by Josi at the time of sampling due to transport and movement of my soil samples prior to the incubations that likely changed their bulk densities.
    
  * A column was added to Josi's data (josi_data spreadsheets = vc_sed_data and bh_sed_data) that converts TOC to SOM. This was done to get an estimate of which particle density value to use for each depth (2.65 g/cm3 for mineral soils, or 1.50 g/cm3 for peat-heavy soils) -- "About 58% of the mass of organic matter exists as carbon. We can estimate the percentage of SOM from the SOC% using the conversion factor 1.72 (derived from 100/58): Organic matter (%) = total organic carbon (%) x 1.72. This conversion factor can vary in different soils, but 1.72 provides a reasonable estimate of SOM for most purposes." https://www.agric.wa.gov.au/measuring-and-assessing-soils/what-soil-organic-carbon
  
  * Particle density (Dp) values were selected from the following studies in order to calculate the total volume of dry soil in each jar. Dp of mineral soils was estimated to be 2.65 g/cm3 - this was applied to all soil depths that had TOC <= 5.8% (SOM <= 10%) as noted in Josi's spreadsheets, because these would be considered mineral soils (this might be a high SOM limit because mineral soils are often noted as having 5% SOM, but because these are peat soils, applying a fully peat Dp of 1.50 g/cm3 seems extreme). Dp of peat soils was estimated to be 1.50 g/cm3 - this was applied to all soil depths that had SOM > 10%.
  
    * Dp of mineral soils (2.65 g/cm3) drawn from the following papers: 
      1) Schjønning, P., McBride, R. A., Keller, T., & Obour, P. B. (2017). Predicting soil particle density from clay and soil organic matter contents. Geoderma, 286, 83–87. https://doi.org/10.1016/j.geoderma.2016.10.020 
      2) Blake, G. R. (2008). Particle Density. Encyclopedia of Earth Sciences Series, Encyclopedia of Earth Sciences Series, 580–581. https://doi.org/10.1201/noe0849338304.ch277

    * Dp of peat soils (1.50 g/cm3) drawn from the following papers: 
      1) Heiskanen, J. (1992). Comparison of three methods for determining the particle density of soil with liquid pycnometers. Communications in Soil Science and Plant Analysis, 23(7–8), 841–846. https://doi.org/10.1080/00103629209368633
      2) Faoziah, N., Iskandar, Djajakirana, G., Darmawan, & Sumawinata, B. (2019). On the development of measurement procedure of particle density for peat material. IOP Conference Series: Earth and Environmental Science, 393(1), 1–4. https://doi.org/10.1088/1755-1315/393/1/012056
  
  * Second, the total amount of CO~2~ and CH~4~ in the headspace needs to be calculated 
    
```{r}
# create a second df (inc_df2) to use for calculations so that all data compiled prior to this point doesn't need to be reloaded if a mistake is made
inc_df2 <- inc_df

# make sure all timpoint values are numeric, add columns for the volume of gas withdrawn from headspace per timepoint in mL and L - this was 7mL for all timepoints and headspace treatments, except ANA T0-T4 = 5mL and ANA T17 and ANA T28 = 14mL (read more below).
# remove rows with NA values in the conc_ppmv column. This needs to be done for samples that were not run on the GC (ANA T18, ANA T29). 7mLs were pulled at T18 even though this timepoint wasn't run (same with T29), so T17 volume will include an additional 7mL to correct for the T18 dilution (same with T28 for the T29 dilution). This will make the assumption that the concentration of ghg taken out at T18 was the same as T17.

inc_df2 <- inc_df2 %>%
  mutate(timepoint = as.numeric(timepoint)) %>%
  drop_na()

inc_df2 <- inc_df2 %>%
  mutate(vol_pulled_ml = ifelse(inc_df2$headspace_treatment == "anaerobic" & inc_df2$timepoint <= 4, 5, ifelse(inc_df2$headspace_treatment == "anaerobic" & inc_df2$timepoint == 17 | inc_df2$timepoint == 28, 14, 7)),
        vol_pulled_l = vol_pulled_ml/1000)

# read in Excel sheet that contains sampling dates and days - cell row ranges were used because this Excel sheet contains written notes at the top
inc_sample_data <- read_excel(sample_key_data, "Incubation Sample Masses", range = cell_rows(4:136))


# select the columns that pertain to sample ID, gravimetric water content (mass water / mass dry soil) at the beginning of the incubations, and the mass of wet soil put into each incubation jar, and join them (by "sample_ID") to the working inc_df2 
# use mutate to add columns for dry soil mass in jar - calculate this by solving for it in the gwc equation [gwc = (mass wet soil - mass dry soil) / mass dry soil] using the sample wet soil mass and the known gwc
inc_df2 <- inc_df2 %>% 
  full_join(select(inc_sample_data, 
                             sample_ID = "Sample ID", 
                             gwc = "1_Gravimetric water content (mass water / mass dry soil)",
                             wet_soil_mass_g = "Mass Soil in Jar (g)")) %>%
  mutate(dry_soil_mass_g = wet_soil_mass_g / (1 + gwc))

# josi's data contains a column for TOC - approximate calculations were run in this sheet to convert TOC to SOM
# insert a column for estimated particle density (Dp, or dp). Based on Josi's data spreadsheets (vc_sed_data and bh_sed_data), depths 2 and 3 (60-76cm and 110-117cm, respectively) will use Dp = 1.50 g/cm3 for peat heavy soils, and all other depths will use Dp = 2.65 g/cm3
# dry soil and water volumes are calculated in cm3, but reported in mL because 1g/cm3 = 1mL
# the average jar volume was empirically measured at 115.6mL of volume when black butyl stoppers were on
# the Ideal Gas Law, PV = nRT, was used to determine the number of moles (n) of air in each jar; R = 8.3145 ((L*kPa)/(mol*K))
# to calculate the amount of umol CO2 or CH4 in the jars, conc_ppmv of gas (equivalent to: umol gas / mol air) was multiplied by total moles of air in each jar
# gas is distinguished from air -  air is the overall composite of gases in the headspace of the jar, while gas is greenhouse gas that is being evaluated in this study = CO2 or CH4

inc_df2 <- inc_df2 %>%
  mutate(dp_g_cm3 = ifelse(inc_df2$depth_ID == "02" | inc_df2$depth_ID == "03", 1.50, 2.65),
         dry_soil_vol_ml = dry_soil_mass_g / dp_g_cm3, 
         water_vol_ml = gwc * dry_soil_mass_g,
         air_vol_ml = 115.6 - dry_soil_vol_ml - water_vol_ml,
         air_vol_l = air_vol_ml / 1000,
         temp_inc_K = 273.15 + temp_treatment_C,
         pressure_kpa = 101.325,
         air_in_jar_mols = (air_vol_l * pressure_kpa) / (8.3145 * temp_inc_K),
         gas_in_jar_umols = conc_ppmv * air_in_jar_mols,
         air_removed_mols = (vol_pulled_l * pressure_kpa) / (8.3145 * temp_inc_K),
         gas_removed_umols = conc_ppmv * air_removed_mols)

# The accumulated umols of gas in the jar need to be corrected for the amount of gas removed from the headspace during the prior timepoint. Do this by adding umols gas in the current timepoint to umols gas removed in the previous timepoint. This will result in accumulated umol CO2 or accumulated umol CH4.

inc_df2 <- inc_df2 %>%
  mutate(accum_gas_umol = 0)

for(i in 1:length(inc_df2$timepoint)){
  inc_df2$accum_gas_umol[i] <- ifelse(inc_df2$timepoint[i] == 0, inc_df2$gas_in_jar_umols[i], (inc_df2$gas_in_jar_umols[i] + inc_df2$gas_removed_umols[i-1]))
}

# add a column for accumulated gas in jar (g CO2 or g CH4)
# add a column for accumulated carbon in jar (g C) - convert g gas (CO2 or CH4) to g C-CO2; C-CO2 refers to gC released as CO2; g gas x [ either 12.01g C / 16.04g CH4, or 12.01g C / 44.01g CH4 ] -> gC (C-CO2 or C-CH4)
# C = 12.01 g/mol, CO2 = 44.01 g/mol, CH4 = 16.04 g/mol

inc_df2 <- inc_df2 %>%
  mutate(accum_gas_g = 
           ifelse(inc_df2$gas_sampled == "CO2", 
                  ((accum_gas_umol / 10^6) * 44.01), 
                  ((accum_gas_umol / 10^6) * 16.04)),
         accum_gas_ug = accum_gas_g * 10^6,
         accum_gas_umolC = accum_gas_umol,
         accum_gas_gC = 
           ifelse(inc_df2$gas_sampled == "CO2", 
                  accum_gas_g * (12.01 / 44.01), 
                  accum_gas_g * (12.01 / 16.04)),
         accum_gas_ugC = accum_gas_gC * 10^6)

```


8. Calculate respiration values
  * Total respiration will be reported in units of ugC (as C-CO2 or C-CH4) per mass of soil C; respiration rates will be reported in units of change in ugC (as C-CO2 or C-CH4) per change in time points, per mass of soil C. For example:
  resp_rate_ugC_d_g = change in accum_gas_ugC / change in samp_int_day / dry_soil_massC_g 

Notes about Josi's data
  * I collected sediment between two depths along the sediment cores for each sample - these are labeled sample_lower_depth_cm and sample_upper_depth_cm in inc_df and inc_df2
  * The distance between these depths was about 14-17cm; differences in distance were due to the amount of sample available for Josi, Susannah, Nancy, and Jen's analyses
  * Josi took samples at a higher resolution than I did in the VC cores, and a lower resolution than I did in BH cores - labeled "Depth (cm) - Sample Midpoint" in her Excel sheets
    * For many of the VC depths that I took sample from, she has 2-3 values for total carbon [ TC (wt%) ]. I will average these for a single TC value that can better represent the amount of soil that I sampled from; then this value will be divided by 100 and multiplied by the dry_soil_mass_g to obtain the dry soil mass as gC
    * For the BH depths that I took sample from, she has 0-1 values for total carbon [ TC (wt%) ] - I will either use the available TC value, or if none is available then I will average the values on either side of my sample depth

```{r}
# Make a total carbon (TC) column with values pulled from Josi's spreadsheets - she expresses TC as a percent of the dry weight of the soil. This column in inc_df2 (TC_perc_wt) will average the TC data from Josi's spreadsheets where multiple values are available, or approximate TC values using upper and lower depths where there aren't values available.


# create a function that coerces several columns to a specific type
# can also do it this way, but numeric_fx is more flexible: vc_sed_data$`TC (wt%)` <- as.numeric(vc_sed_data$`TC (wt%)`)
numeric_fx <- function(df, columns = names(df), coerce_as = as.numeric){
  df[columns] = lapply(df[columns], coerce_as)
    df
}

# convert columns in vc_sed_data to same type as bh_sed_data
vc_sed_data <- numeric_fx(vc_sed_data, c(16, 19:20))

# combine josi's two dfs into one, and rename select columns
sed_chars <- full_join(vc_sed_data, bh_sed_data) %>%
  rename(core_ID = "Core ID", depth_cm = "Depth (cm) - Sample Midpoint", TC_perc_wt = "TC (wt%)")

# change core IDs so that they match inc_df2 
for (i in sed_chars$core_ID){
  if(nchar(i) == 8){
    sed_chars$core_ID[sed_chars$core_ID == i] <- paste("GSL18_VC_11_", substring(i, 6, 6), sep = "")
  } else if(nchar(i) == 4) {
    sed_chars$core_ID[sed_chars$core_ID == i] <- paste("GSL18_DC_BH1", substring(i, 1, 2), substring(i, 4, 4), sep = "_")
  } else {
    sed_chars$core_ID[sed_chars$core_ID == i] <- paste("GSL18_DC_BH1", substring(i, 1, 3), substring(i, 5, 5), sep = "_")
  }
}

# select a subset of columns to work with from sed_chars
tc_data <- sed_chars %>%
  select(core_ID, depth_cm, TC_perc_wt)

# make sure everything is numeric 
tc_data <- numeric_fx(tc_data, 2)
core_depths <- numeric_fx(core_depths, 1:2)

# tc_data$depth_cm <- as.numeric(tc_data$depth_cm)
# core_depths$sample_depth_lower_cm <- as.numeric(core_depths$sample_depth_lower_cm)
# core_depths$sample_depth_upper_cm <- as.numeric(core_depths$sample_depth_upper_cm)

# create two empty lists and add lower and upper depths to them that correspond to inc_df2 depths
lower_depths <- list()
upper_depths <- list()

for (i in core_depths$sample_depth_lower_cm){
  lower_depths <- append(lower_depths, as.numeric(i), after = length(lower_depths))
}

for (i in core_depths$sample_depth_upper_cm){
  upper_depths <- append(upper_depths, as.numeric(i), after = length(upper_depths))
}

# make two new dfs, these will be used to add rows with averaged TC values - df_tc will be used where Josi has 2-3 values for my sampling depths, df_tc2 will be used where she has 0-1 values for by sampling depths - these will then be combined into one df
df_tc <- data.frame("sample_depth_lower_cm" = numeric(0), 
                    "sample_depth_upper_cm" = numeric(0),
                    "TC_perc_wt" = numeric(0))
df_tc2 <- data.frame("sample_depth_lower_cm" = numeric(0), 
                    "sample_depth_upper_cm" = numeric(0),
                    "TC_perc_wt" = numeric(0))

# filter Josi's data where her depths fall between mine, and then average TC values for those depths
# add averaged TC values from Josi's data and their corresponding lower depth measurements from my data to an empty df_tc

for (i in 1:length(lower_depths)){
  filtered_rows <- tc_data %>%
    filter(tc_data$depth_cm >= lower_depths[i] & tc_data$depth_cm <= upper_depths[i])
  avg_tc <- mean(filtered_rows$TC_perc_wt)
  df_tc <- rbind(df_tc[1:i,], c(lower_depths[i], upper_depths[i], avg_tc), make.row.names = FALSE)
}

# remove the NAs from row 1 of df_tc
df_tc <- df_tc[-c(1),]

# create a vector for lower depths and upper depths that have NA values in the TC_perc_wt column of df_tc - these will be used to pull depths with 0-1 values from Josi's DC_BH1 core values
lower_depths_dc <- c()
upper_depths_dc <- c()
for (i in 1:length(df_tc$sample_depth_lower_cm)){
  if (df_tc$TC_perc_wt[i] == "NaN"){
    lower_depths_dc[i] <- df_tc$sample_depth_lower_cm[i]
    upper_depths_dc[i] <- df_tc$sample_depth_upper_cm[i]
  }
}

# remove NA values from the vectors
lower_depths_dc <- lower_depths_dc[!is.na(lower_depths_dc)]
upper_depths_dc <- upper_depths_dc[!is.na(upper_depths_dc)]

# sort the tc_data in ascending order so that the match.closest() function [MALDIquant package] can be used on it; then match the values in the vectors above to the closest values in tc_data by index number; average those values for a TC value and input this into df_tc

tc_data_sorted <- tc_data[order(tc_data$depth_cm),]
lower_pos <- match.closest(lower_depths_dc, tc_data_sorted$depth_cm)
upper_pos <- match.closest(upper_depths_dc, tc_data_sorted$depth_cm)
for (i in 1:length(lower_pos)){
  avg_tc <- mean(c(tc_data_sorted$TC_perc_wt[lower_pos[i]], tc_data_sorted$TC_perc_wt[upper_pos[i]]))
  df_tc2 <- rbind(df_tc2[1:i,], c(lower_depths_dc[i], upper_depths_dc[i], avg_tc), make.row.names = FALSE)
}

# remove the NAs from df_tc and df_tc2 and join them into one df that is sorted by depth
df_tc <- na.omit(df_tc)
df_tc2 <- na.omit(df_tc2)

df_all_tc <- full_join(df_tc, df_tc2) %>% 
  arrange(sample_depth_lower_cm)

# make sure columns in inc_df2 are numeric, then join df_all_tc to inc_df2
inc_df2 <- inc_df2 %>%
  numeric_fx(2:3) %>% 
  left_join(df_all_tc)

# add a column for the mass of dry soil in each jar that was carbon, then calculate: 
# 1) accumulated gas in the headspace of each jar (e.g. accum_gas_ug_gC, accum_gas_ugC_gC) - this is the total respired gas and/or C per gram of soil C; 
# 2) total respiration between sampling timepoints (resp_ug_gC, resp_ugC_gC) - this is the difference in respired gas and/or C between each timepoint per gram of soil C;
# 3) respiration rate (resp_rate_ug_d_gC, resp_rate_ugC_d_gC) - this is the difference in respired gas and/or C, per the difference in days, per gram of soil C
inc_df2 <- inc_df2 %>%
  mutate(dry_soil_massC_g = (TC_perc_wt / 100) * dry_soil_mass_g,
         dry_soil_massC_ug = dry_soil_massC_g * 10^6,
         accum_gas_ug_gC = accum_gas_ug / dry_soil_massC_g,
         accum_gas_ug_ugC = accum_gas_ug / dry_soil_massC_ug,
         accum_gas_ugC_gC = accum_gas_ugC / dry_soil_massC_g,
         accum_gas_ugC_ugC = accum_gas_ugC / dry_soil_massC_ug,
         resp_ug_ugC = 0,
         resp_ugC_ugC = 0,
         resp_ugC_gC = 0,
         resp_rate_ug_d_ugC = 0,
         resp_rate_ugC_d_ugC = 0,
         resp_rate_ugC_d_gC = 0,
         resp_rate_ug_hr_ugC = 0,
         resp_rate_ugC_hr_ugC = 0,
         resp_rate_ugC_hr_gC = 0)

# add a column for sample depth range in meters - this will be used later for graphs
inc_df2 <- inc_df2 %>%
  add_column(sample_depth_lower_m = 0, sample_depth_upper_m = 0, .after = "sample_depth_upper_cm") %>%
  mutate(sample_depth_lower_m = sample_depth_lower_cm/100, 
         sample_depth_upper_m = sample_depth_upper_cm/100) %>%
  unite("sample_depth_range_m", "sample_depth_lower_m":"sample_depth_upper_m", sep = "-")


for(i in 1:length(inc_df2$dry_soil_massC_g)){
  # resp_ug_ugC column pertains to the change in ug CO2 or CH4 respired between timepoints per ugC in soil
  inc_df2$resp_ug_ugC[i] <- 
    ifelse(inc_df2$timepoint[i] == 0, 0, 
           (inc_df2$accum_gas_ug_ugC[i] - inc_df2$accum_gas_ug_ugC[i-1]))
  
  # resp_ugC_ugC column pertains to the change in ugC (C-CO2 or C-CH4) respired between timepoints per ugC in soil
  inc_df2$resp_ugC_ugC[i] <- 
    ifelse(inc_df2$timepoint[i] == 0, 0, 
           (inc_df2$accum_gas_ugC_ugC[i] - inc_df2$accum_gas_ugC_ugC[i-1]))
  
  # resp_ugC_gC column pertains to the change in ugC (C-CO2 or C-CH4) respired between timepoints per gC in soil
  inc_df2$resp_ugC_gC[i] <- (inc_df2$resp_ugC_ugC[i] * 10^6)
  
  # resp_rate_ug_d_ugC column pertains to the change in ug CO2 or CH4 respired per change in days between timepoints per ugC in soil
  inc_df2$resp_rate_ug_d_ugC[i] <- 
    ifelse(inc_df2$timepoint[i] == 0, 0, 
           (inc_df2$resp_ug_ugC[i] / (inc_df2$samp_int_day[i] - inc_df2$samp_int_day[i-1])))
  
  # resp_rate_ugC_d_ugC column pertains to ugC (C-CO2 or C-CH4) respired per change in days between timepoints per ugC in soil
  inc_df2$resp_rate_ugC_d_ugC[i] <- 
    ifelse(inc_df2$timepoint[i] == 0, 0, 
           (inc_df2$resp_ugC_ugC[i] / (inc_df2$samp_int_day[i] - inc_df2$samp_int_day[i-1])))
  
  # resp_rate_ugC_d_gC column pertains to ugC (C-CO2 or C-CH4) respired per change in days between timepoints per gC in soil
  inc_df2$resp_rate_ugC_d_gC[i] <- (inc_df2$resp_rate_ugC_d_ugC[i] * 10^6)
  
  # resp_rate_ug_hr_ugC column pertains to ug CO2 or CH4 respired per change in hours between timepoints per ugC in soil
  inc_df2$resp_rate_ug_hr_ugC[i] <- (inc_df2$resp_rate_ug_d_ugC[i] / 24)
  
  # resp_rate_ugC_hr_ugC column pertains to ugC (C-CO2 or C-CH4) respired per change in hours between timepoints per ugC in soil
  inc_df2$resp_rate_ugC_hr_ugC[i] <- (inc_df2$resp_rate_ugC_d_ugC[i] / 24)
  
  # resp_rate_ugC_hr_gC column pertains to ugC (C-CO2 or C-CH4) respired per change in hours between timepoints per gC in soil
  inc_df2$resp_rate_ugC_hr_gC[i] <- (inc_df2$resp_rate_ugC_hr_ugC[i] * 10^6)
  
}

```

9. Create a summarized df with averages of replicates and standard errors

```{r}
# create another df for summarized (averaged) values of the replicates at each timepoint - averages and standard erros will be calculated for replicates 1-3, 4-6, and 7-9


summ_vals <- inc_df2
summ_vals <- summ_vals[order(summ_vals$depth_ID, summ_vals$timepoint),] %>%
  mutate(avg_accum_gas_umolC = NA,
         se_accum_gas_umolC = NA,
         avg_accum_gas_ugC = NA,
         se_accum_gas_ugC = NA,
         avg_accum_gas_ugC_ugC = NA,
         se_accum_gas_ugC_ugC = NA,
         avg_accum_gas_ugC_gC = NA,
         se_accum_gas_ugC_gC = NA,
         avg_resp_rate_ugC_d_ugC = NA,
         se_resp_rate_ugC_d_ugC = NA,
         avg_resp_rate_ugC_d_gC = NA,
         se_resp_rate_ugC_d_gC = NA,
         avg_resp_rate_ugC_hr_ugC = NA,
         se_resp_rate_ugC_hr_ugC = NA,
         avg_resp_rate_ugC_hr_gC = NA,
         se_resp_rate_ugC_hr_gC = NA)

# populate summ_vals with means and standard errors of replicates 1-3, 4-6, 7-9
# standard error is calculated as [ standard deviation / sqrt(n) ], where n = # replicates (e.g 1-3 = 3) 
# unnecessary replicate rows were removed, remaining ones denote the beginning of the replicate set (replicate 1 remains for averaged 1-3 values, replicate 4 for averaged 4-6 values, replicate 7 remains for averaged 7-9 values) - note that because rows are removed, while the summary columns pertain to averaged values across replicates, the columns that precede it contain data that is specific to one of those replicates and are not averaged values (1, 4, or 9)
# to clean this up, can I use dplyr group_by() to obtain summary stats?

for (i in 1:length(summ_vals$avg_accum_gas_umolC)){
  if (summ_vals$replicate[i] == 1 | summ_vals$replicate[i] == 4 | summ_vals$replicate[i] == 7){
    
     # average and find the standard error for the column: accum_gas_umolC
    summ_vals$avg_accum_gas_umolC[i] <- mean(c(summ_vals$accum_gas_umolC[i], summ_vals$accum_gas_umolC[i+1], summ_vals$accum_gas_umolC[i+2]))
    summ_vals$se_accum_gas_umolC[i] <- sd(c(summ_vals$accum_gas_umolC[i], summ_vals$accum_gas_umolC[i+1], summ_vals$accum_gas_umolC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: accum_gas_ugC
    summ_vals$avg_accum_gas_ugC[i] <- mean(c(summ_vals$accum_gas_ugC[i], summ_vals$accum_gas_ugC[i+1], summ_vals$accum_gas_ugC[i+2]))
    summ_vals$se_accum_gas_ugC[i] <- sd(c(summ_vals$accum_gas_ugC[i], summ_vals$accum_gas_ugC[i+1], summ_vals$accum_gas_ugC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: accum_gas_ugC_ugC
    summ_vals$avg_accum_gas_ugC_ugC[i] <- mean(c(summ_vals$accum_gas_ugC_ugC[i], summ_vals$accum_gas_ugC_ugC[i+1], summ_vals$accum_gas_ugC_ugC[i+2]))
    summ_vals$se_accum_gas_ugC_ugC[i] <- sd(c(summ_vals$accum_gas_ugC_ugC[i], summ_vals$accum_gas_ugC_ugC[i+1], summ_vals$accum_gas_ugC_ugC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: accum_gas_ugC_gC
    summ_vals$avg_accum_gas_ugC_gC[i] <- mean(c(summ_vals$accum_gas_ugC_gC[i], summ_vals$accum_gas_ugC_gC[i+1], summ_vals$accum_gas_ugC_gC[i+2]))
    summ_vals$se_accum_gas_ugC_gC[i] <- sd(c(summ_vals$accum_gas_ugC_gC[i], summ_vals$accum_gas_ugC_gC[i+1], summ_vals$accum_gas_ugC_gC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: resp_rate_ugC_d_ugC 
    summ_vals$avg_resp_rate_ugC_d_ugC[i] <- mean(c(summ_vals$resp_rate_ugC_d_ugC[i], summ_vals$resp_rate_ugC_d_ugC[i+1], summ_vals$resp_rate_ugC_d_ugC[i+2]))
    summ_vals$se_resp_rate_ugC_d_ugC[i] <- sd(c(summ_vals$resp_rate_ugC_d_ugC[i], summ_vals$resp_rate_ugC_d_ugC[i+1], summ_vals$resp_rate_ugC_d_ugC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: resp_rate_ugC_d_gC 
    summ_vals$avg_resp_rate_ugC_d_gC[i] <- mean(c(summ_vals$resp_rate_ugC_d_gC[i], summ_vals$resp_rate_ugC_d_gC[i+1], summ_vals$resp_rate_ugC_d_gC[i+2]))
    summ_vals$se_resp_rate_ugC_d_gC[i] <- sd(c(summ_vals$resp_rate_ugC_d_gC[i], summ_vals$resp_rate_ugC_d_gC[i+1], summ_vals$resp_rate_ugC_d_gC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: resp_rate_ugC_hr_ugC
    summ_vals$avg_resp_rate_ugC_hr_ugC[i] <- mean(c(summ_vals$resp_rate_ugC_hr_ugC[i], summ_vals$resp_rate_ugC_hr_ugC[i+1], summ_vals$resp_rate_ugC_hr_ugC[i+2]))
    summ_vals$se_resp_rate_ugC_hr_ugC[i] <- sd(c(summ_vals$resp_rate_ugC_hr_ugC[i], summ_vals$resp_rate_ugC_hr_ugC[i+1], summ_vals$resp_rate_ugC_hr_ugC[i+2])) / sqrt(3)
    
    # average and find the standard error for the column: resp_rate_ugC_hr_gC
    summ_vals$avg_resp_rate_ugC_hr_gC[i] <- mean(c(summ_vals$resp_rate_ugC_hr_gC[i], summ_vals$resp_rate_ugC_hr_gC[i+1], summ_vals$resp_rate_ugC_hr_gC[i+2]))
    summ_vals$se_resp_rate_ugC_hr_gC[i] <- sd(c(summ_vals$resp_rate_ugC_hr_gC[i], summ_vals$resp_rate_ugC_hr_gC[i+1], summ_vals$resp_rate_ugC_hr_gC[i+2])) / sqrt(3)
    
  }
}

# Remove NA values from the summarized values dataframe (summ_vals)
summ_vals <- summ_vals %>% 
  filter(!is.na(avg_accum_gas_umolC))
```


10. Create general plots

```{r}
# # never use $ in aes() - it breaks associations with the plot
# # geom_point() produces a scatterplot and understands the "shape" aes
# # geom_line() understands the aes "linetype", which maps a categorical variable to solid, dotted, and dashed lines
# # p <- ggplot(df, aes(x, y, label = label)) + 
#   # labs(x = NULL, y = NULL) + # Hide axis label
#   # theme(plot.title = element_text(size = 12)) # Shrink plot title
# # p + geom_line() + ggtitle("line")
# # if a group isn’t defined by a single variable, but instead by a combination of multiple variables, use interaction() to combine them, e.g. aes(group = interaction(school_id, student_id)).
# 
# 
# # add more colors to plots - 1) choose a classic R color palette, list its usual number of colors and palette identifier, 2) add more colors "(12)" to this palette; can then plot it using " + scale_color_manual(values = col_pal)"
# col_pal <- brewer.pal(8, "Accent") 
# col_pal <- colorRampPalette(col_pal)(12)
# 
# 
# # CREATE A PLOT THEME
# 
# # --------  ANAEROBIC DATA: ACCUMULATED GAS IN JARS  --------
# 
# # --- ANAEROBIC CO2 ---
# 
# # plot all ANAEROBIC CO2 data
# # not normalized by ugC
# plt_ana_co2 <- inc_df2 %>% 
#   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CO2 respired")
# print(plt_ana_co2)
# 
# # normalized by ugC
# plt_ana_co2_ugC <- inc_df2 %>% 
#   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CO2 respired (normalized by ug soil C)")
# print(plt_ana_co2_ugC)
# 
# # # normalized by gC
# # plt_ana_co2_gC <- inc_df2 %>% 
# #   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C),
# #              group = interaction(depth_ID, replicate))) + 
# #   geom_line() + 
# #   geom_point() +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative anaerobic C-CO2 respired (normalized by g soil C)")
# # print(plt_ana_co2_gC)
# 
# # plot AVG. ANAEROBIC CO2 data using average replicate values (remove days where all samples precipitously drop in gas concentration)
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# # can remove timepoints by adding this to filter: & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54
# # not normalized by ugC
# plt_avg_ana_co2 <- summ_vals %>%
#   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CO2 respired - replicate averages")
# print(plt_avg_ana_co2)
# 
# # normalized by ugC
# plt_avg_ana_co2_ugC <- summ_vals %>%
#   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC_ugC - se_accum_gas_ugC_ugC, ymax = avg_accum_gas_ugC_ugC + se_accum_gas_ugC_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CO2 respired - replicate averages (normalized by ug soil C)")
# print(plt_avg_ana_co2_ugC)
# 
# # # normalized by gC
# # plt_avg_ana_co2_gC <- summ_vals %>%
# #   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C), 
# #              group = interaction(depth_ID, temp_treatment_C))) + 
# #   geom_line() + 
# #   geom_point() +
# #   geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative anaerobic C-CO2 respired - replicate averages (normalized by ug soil C)")
# # print(plt_avg_ana_co2_gC)
# 
# 
# # --- ANAEROBIC CH4 ---
# 
# # plot all ANAEROBIC CH4 data:
# # not normalized by ugC
# plt_ana_ch4 <- inc_df2 %>% 
#   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CH4 respired")
# print(plt_ana_ch4)
# 
# # normalized by ugC
# plt_ana_ch4_ugC <- inc_df2 %>% 
#   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CH4 respired (normalized by ug soil C)")
# print(plt_ana_ch4_ugC)
# 
# # # normalized by gC
# # plt_ana_ch4_gC <- inc_df2 %>% 
# #   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C),
# #              group = interaction(depth_ID, replicate))) + 
# #   geom_line() + 
# #   geom_point() +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative anaerobic C-CH4 respired (normalized by g soil C)")
# # print(plt_ana_ch4_gC)
# 
# # plot AVG. ANAEROBIC CH4 data using average replicate values
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# # not normalized by ugC
# plt_avg_ana_ch4 <- summ_vals %>%
#   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CH4 respired - replicate averages")
# print(plt_avg_ana_ch4)
# 
# # normalized by ugC
# plt_avg_ana_ch4_ugC <- summ_vals %>%
#   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC_ugC - se_accum_gas_ugC_ugC, ymax = avg_accum_gas_ugC_ugC + se_accum_gas_ugC_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative anaerobic C-CH4 respired - replicate averages (normalized by ug soil C)")
# print(plt_avg_ana_ch4_ugC)
# 
# # # normalized by gC
# # plt_avg_ana_ch4_gC <- summ_vals %>%
# #   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C), 
# #              group = interaction(depth_ID, temp_treatment_C))) + 
# #   geom_line() + 
# #   geom_point() +
# #   geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative anaerobic C-CH4 respired - replicate averages (normalized by g soil C)")
# # print(plt_avg_ana_ch4_gC)
# 
# 
# # --------  AEROBIC DATA: ACCUMULATED GAS IN JARS  --------
# 
# # --- AEROBIC CO2 ---
# 
# # plot all AEROBIC CO2 data
# # not normalized by ugC
# plt_aer_co2 <- inc_df2 %>% 
#   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CO2 respired")
# print(plt_aer_co2)
# 
# # normalized by ugC
# plt_aer_co2_ugC <- inc_df2 %>% 
#   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CO2 respired (normalized by ug soil C)")
# print(plt_aer_co2_ugC)
# 
# # # normalized by gC
# # plt_aer_co2_gC <- inc_df2 %>% 
# #   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C),
# #              group = interaction(depth_ID, replicate))) + 
# #   geom_line() + 
# #   geom_point() +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative aerobic C-CO2 respired (normalized by g soil C)")
# # print(plt_aer_co2_gC)
# 
# 
# # plot AVG. AEROBIC CO2 data using average replicate values (remove days where all samples precipitously drop in gas concentration)
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# # can remove timepoints by adding this to filter: & samp_int_day != 99 & samp_int_day != 104
# # not normalized by ugC
# plt_avg_aer_co2 <- summ_vals %>%
#   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CO2 respired - replicate averages")
# print(plt_avg_aer_co2)
# 
# # normalized by ugC
# plt_avg_aer_co2_ugC <- summ_vals %>%
#   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC_ugC - se_accum_gas_ugC_ugC, ymax = avg_accum_gas_ugC_ugC + se_accum_gas_ugC_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CO2 respired - replicate averages (normalized by ug soil C)")
# print(plt_avg_aer_co2_ugC)
# 
# # # normalized by gC
# # plt_avg_aer_co2_gC <- summ_vals %>%
# #   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C), 
# #              group = interaction(depth_ID, temp_treatment_C))) + 
# #   geom_line() + 
# #   geom_point() +
# #   geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative aerobic C-CO2 respired - replicate averages (normalized by g soil C)")
# # print(plt_avg_aer_co2_gC)
# 
# 
# # --- AEROBIC CH4 ---
# 
# # plot all AEROBIC CH4 data:
# # not normalized by ugC
# plt_aer_ch4 <- inc_df2 %>% 
#   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CH4 respired")
# print(plt_aer_ch4)
# 
# # normalized by ugC
# plt_aer_ch4_ugC <- inc_df2 %>% 
#   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C),
#              group = interaction(depth_ID, replicate))) + 
#   geom_line() + 
#   geom_point() +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CH4 respired (normalized by ug soil C)")
# print(plt_aer_ch4_ugC)
# 
# # # normalized by gC
# # plt_aer_ch4_gC <- inc_df2 %>% 
# #   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C),
# #              group = interaction(depth_ID, replicate))) + 
# #   geom_line() + 
# #   geom_point() +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative aerobic C-CH4 respired (normalized by g soil C)")
# # print(plt_aer_ch4_gC)
# 
# # plot AVG. AEROBIC CH4 data using average replicate values
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# # not normalized by ugC
# plt_avg_aer_ch4 <- summ_vals %>%
#   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CH4 respired - replicate averages")
# print(plt_avg_aer_ch4)
# 
# # normalized by ugC
# plt_avg_aer_ch4_ugC <- summ_vals %>%
#   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = avg_accum_gas_ugC_ugC, x = samp_int_day, 
#              color = depth_ID, linetype = factor(temp_treatment_C), 
#              group = interaction(depth_ID, temp_treatment_C))) + 
#   geom_line() + 
#   geom_point() +
#   geom_errorbar(aes(ymin = avg_accum_gas_ugC_ugC - se_accum_gas_ugC_ugC, ymax = avg_accum_gas_ugC_ugC + se_accum_gas_ugC_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Cumulative aerobic C-CH4 respired - replicate averages (normalized by ug soil C)")
# print(plt_avg_aer_ch4_ugC)
# 
# # # normalized by gC
# # plt_avg_aer_ch4_gC <- summ_vals %>%
# #   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day, 
# #              color = depth_ID, linetype = factor(temp_treatment_C), 
# #              group = interaction(depth_ID, temp_treatment_C))) + 
# #   geom_line() + 
# #   geom_point() +
# #   geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Cumulative aerobic C-CH4 respired - replicate averages (normalized by g soil C)")
# # print(plt_avg_aer_ch4_gC)
# 
# 
# # 2nd round of plots: respiration rate (CO2 or CH4 per g C in soil) by timepoint ; do this between each timepoint, then do this by taking a slope of each month ?
# 
# 
# # --------  ANAEROBIC DATA: RESPIRATION RATES  --------
# 
# # plot AVG. ANAEROBIC CO2 respiration rate (remove days where all samples precipitously drop in gas concentration)
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# # can remove timepoints by adding this to filter: & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54
# 
# # respiration rate per change in days
# plt_avg_resp_rate_ana_CO2_d_ugC <- summ_vals %>%
#   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = avg_resp_rate_ugC_d_ugC, x = samp_int_day, 
#              color = depth_ID, 
#              group = interaction(depth_ID, temp_treatment_C))) +
#   geom_point(aes(shape = factor(temp_treatment_C))) +
#   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_ugC - se_resp_rate_ugC_d_ugC, ymax = avg_resp_rate_ugC_d_ugC + se_resp_rate_ugC_d_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Anaerobic C-CO2 respiration rate (days) - replicate averages, normalized by ug soil C")
# print(plt_avg_resp_rate_ana_CO2_d_ugC)
# 
# # # respiration rate per change in days
# # plt_avg_resp_rate_ana_CO2_d_gC <- summ_vals %>%
# #   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Anaerobic C-CO2 respiration rate (days) - replicate averages, normalized by g soil C")
# # print(plt_avg_resp_rate_ana_CO2_d_gC)
# 
# # # respiration rate per change in hours
# # plt_avg_resp_rate_ana_CO2_hr_ugC <- summ_vals %>%
# #   filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_hr_ugC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_hr_ugC - se_resp_rate_ugC_hr_ugC, ymax = avg_resp_rate_ugC_hr_ugC + se_resp_rate_ugC_hr_ugC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Anaerobic C-CO2 respiration rate (hours) - replicate averages, normalized by ug soil C")
# # print(plt_avg_resp_rate_ana_CO2_hr_ugC)
# 
# 
# # plot AVG. ANAEROBIC CH4 respiration rate
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# 
# # respiration rate per change in days
# plt_avg_resp_rate_ana_CH4_d_ugC <- summ_vals %>%
#   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
#   ggplot(aes(y = avg_resp_rate_ugC_d_ugC, x = samp_int_day, 
#              color = depth_ID, 
#              group = interaction(depth_ID, temp_treatment_C))) +
#   geom_point(aes(shape = factor(temp_treatment_C))) +
#   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_ugC - se_resp_rate_ugC_d_ugC, ymax = avg_resp_rate_ugC_d_ugC + se_resp_rate_ugC_d_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Anaerobic C-CH4 respiration rate (days) - replicate averages, normalized by ug soil C")
# print(plt_avg_resp_rate_ana_CH4_d_ugC)
# 
# # # respiration rate per change in days
# # plt_avg_resp_rate_ana_CH4_d_gC <- summ_vals %>%
# #   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Anaerobic C-CH4 respiration rate (days) - replicate averages, normalized by g soil C")
# # print(plt_avg_resp_rate_ana_CH4_d_gC)
# 
# # # respiration rate per change in hours
# # plt_avg_resp_rate_ana_CH4_hr_ugC <- summ_vals %>%
# #   filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_hr_ugC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_hr_ugC - se_resp_rate_ugC_hr_ugC, ymax = avg_resp_rate_ugC_hr_ugC + se_resp_rate_ugC_hr_ugC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Anaerobic C-CH4 respiration rate (hours) - replicate averages, normalized by ug soil C")
# # print(plt_avg_resp_rate_ana_CH4_hr_ugC)
# 
# 
# # --------  AEROBIC DATA: RESPIRATION RATES  --------
# 
# # plot AVG. AEROBIC CO2 respiration rate (remove days where all samples precipitously drop in gas concentration)
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# # can remove timepoints by adding this to filter: & samp_int_day != 99 & samp_int_day != 104 
# 
# # respiration rate per change in days
# plt_avg_resp_rate_aer_CO2_d_ugC <- summ_vals %>%
#   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = avg_resp_rate_ugC_d_ugC, x = samp_int_day, 
#              color = depth_ID, 
#              group = interaction(depth_ID, temp_treatment_C))) +
#   geom_point(aes(shape = factor(temp_treatment_C))) +
#   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_ugC - se_resp_rate_ugC_d_ugC, ymax = avg_resp_rate_ugC_d_ugC + se_resp_rate_ugC_d_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Aerobic C-CO2 respiration rate (days) - replicate averages, normalized by ug soil C")
# print(plt_avg_resp_rate_aer_CO2_d_ugC)
# 
# # # respiration rate per change in days
# # plt_avg_resp_rate_aer_CO2_d_gC <- summ_vals %>%
# #   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Aerobic C-CO2 respiration rate (days) - replicate averages, normalized by g soil C")
# # print(plt_avg_resp_rate_aer_CO2_d_gC)
# 
# # # respiration rate per change in hours
# # plt_avg_resp_rate_aer_CO2_hr_ugC <- summ_vals %>%
# #   filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_hr_ugC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_hr_ugC - se_resp_rate_ugC_hr_ugC, ymax = avg_resp_rate_ugC_hr_ugC + se_resp_rate_ugC_hr_ugC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Aerobic C-CO2 respiration rate (hours) - replicate averages, normalized by ug soil C")
# # print(plt_avg_resp_rate_aer_CO2_hr_ugC)
# 
# 
# # plot AVG. AEROBIC CH4 respiration rate
# # can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# 
# # respiration rate per change in days
# plt_avg_resp_rate_aer_CH4_d_ugC <- summ_vals %>%
#   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
#   ggplot(aes(y = avg_resp_rate_ugC_d_ugC, x = samp_int_day, 
#              color = depth_ID, 
#              group = interaction(depth_ID, temp_treatment_C))) +
#   geom_point(aes(shape = factor(temp_treatment_C))) +
#   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_ugC - se_resp_rate_ugC_d_ugC, ymax = avg_resp_rate_ugC_d_ugC + se_resp_rate_ugC_d_ugC), width = 0.2) +
#   scale_color_manual(values = col_pal) +
#   ggtitle("Aerobic C-CH4 respiration rate (days) - replicate averages, normalized by ug soil C")
# print(plt_avg_resp_rate_aer_CH4_d_ugC)
# 
# # # respiration rate per change in days
# # plt_avg_resp_rate_aer_CH4_d_gC <- summ_vals %>%
# #   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Aerobic C-CH4 respiration rate (days) - replicate averages, normalized by g soil C")
# # print(plt_avg_resp_rate_aer_CH4_d_gC)
# 
# # # respiration rate per change in hours
# # plt_avg_resp_rate_aer_CH4_hr_ugC <- summ_vals %>%
# #   filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
# #   ggplot(aes(y = avg_resp_rate_ugC_hr_ugC, x = samp_int_day, 
# #              color = depth_ID, 
# #              group = interaction(depth_ID, temp_treatment_C))) +
# #   geom_point(aes(shape = factor(temp_treatment_C))) +
# #   geom_errorbar(aes(ymin = avg_resp_rate_ugC_hr_ugC - se_resp_rate_ugC_hr_ugC, ymax = avg_resp_rate_ugC_hr_ugC + se_resp_rate_ugC_hr_ugC), width = 0.2) +
# #   scale_color_manual(values = col_pal) +
# #   ggtitle("Aerobic C-CH4 respiration rate (hours) - replicate averages, normalized by ug soil C")
# # print(plt_avg_resp_rate_aer_CH4_hr_ugC)

```

11. Create plots for cumulative respiration - anaerobic and aerobic (master's thesis)

```{r}
# never use $ in aes() - it breaks associations with the plot
# factor distinguishes points as discrete not continuous in terms of their aesthetic (color, linetype)
# group = interaction() distinguishes groups of points (in this case depths+replicates) by their aesthetic value (color, linetype)
# can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually
# geom_point() produces a scatterplot and understands the "shape" aes
# geom_line() understands the aes "linetype", which maps a categorical variable to solid, dotted, and dashed lines
# p <- ggplot(df, aes(x, y, label = label)) + 
  # labs(x = NULL, y = NULL) + # Hide axis label
  # theme(plot.title = element_text(size = 12)) # Shrink plot title
# p + geom_line() + ggtitle("line")
# if a group isn’t defined by a single variable, but instead by a combination of multiple variables, use interaction() to combine them, e.g. aes(group = interaction(school_id, student_id)).


# add more colors to plots - 1) choose a classic R color palette, list its usual number of colors and palette identifier, 2) add more colors "(12)" to this palette; can then plot it using " + scale_color_manual(values = col_pal)"
col_pal <- brewer.pal(8, "Accent") 
col_pal <- colorRampPalette(col_pal)(12)


# CREATE A PLOT THEME

# --------  ANAEROBIC DATA: ACCUMULATED GAS IN JARS  --------

# --- ANAEROBIC CO2 ---

# plot 12 months of ANAEROBIC C-CO2 data
# not normalized by gC
plt_ana_co2 <- inc_df2 %>% 
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) + 
  geom_line() + 
  geom_point() +
  labs(title = "Cumulative anaerobic C-CO2 respired", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_co2)

# plot 12 months of ANAEROBIC C-CO2 data
# normalized by gC
plt_ana_co2_gC <- inc_df2 %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative anaerobic C-CO2 respired (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_co2_gC)

# plot first 3 months of ANAEROBIC C-CO2 data
# not normalized by gC, corrected for dips on days 40, 47, 54
plt_ana_co2_corr <- inc_df2 %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative anaerobic C-CO2 respired", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_co2_corr)

# plot first 3 months of ANAEROBIC C-CO2 data
# normalized by gC, corrected for dips on days 40, 47, 54
plt_ana_co2_gC_corr <- inc_df2 %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative anaerobic C-CO2 respired (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_co2_gC_corr)

# plot 12 months of AVG. ANAEROBIC C-CO2 data using replicate values
# not normalized by gC
plt_avg_ana_co2 <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CO2 respired - replicate averages", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_co2)

# plot 12 months of AVG. ANAEROBIC C-CO2 data using replicate values
# normalized by gC
plt_avg_ana_co2_gC <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CO2 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_co2_gC)


# plot first 3 months of AVG. ANAEROBIC C-CO2 data using replicate values
# not normalized by gC, corrected for dips on days 40, 47, 54
plt_avg_ana_co2_corr <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CO2 respired - replicate averages", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_co2_corr)

# plot 3 months of AVG. ANAEROBIC C-CO2 data using replicate values, with shallowest vs. deepest depths highlighted
# shallowest depth is at 0.31-0.47m and deepest depth is at 19.83-19.98m
# not normalized by gC, corrected for dips on days 40, 47, 54
# FYI - legends here are not updated

# shallow
color_lines_shal_31cm <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54 & sample_depth_lower_cm == 31)

# deep
color_lines_deep_1983cm <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54 & sample_depth_lower_cm == 1983)

# plot
plt_avg_ana_co2_corr_shal_deep <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line(color = "grey") + 
  geom_point(color = "grey") +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2, color = "grey") +
  labs(title = "Cumulative anaerobic C-CO2 respired - replicate averages", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98")) +
  geom_line(mapping = NULL, data = color_lines_shal_31cm, color = col_pal[1], size = 0.7, show.legend = FALSE) +
  geom_line(mapping = NULL, data = color_lines_deep_1983cm, color = col_pal[12], size = 0.7, show.legend = FALSE)

print(plt_avg_ana_co2_corr_shal_deep)

# plot 3 months of AVG. ANAEROBIC C-CO2 data using replicate values
# normalized by gC, corrected for dips on days 40, 47, 54
plt_avg_ana_co2_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CO2 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_co2_gC_corr)


# --- ANAEROBIC CH4 ---

# plot 12 months of ANAEROBIC C-CH4 data
# not normalized by gC
plt_ana_ch4 <- inc_df2 %>% 
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) + 
  geom_line() + 
  geom_point() +
  labs(title = "Cumulative anaerobic C-CH4 respired", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_ch4)

# plot 12 months of ANAEROBIC C-CH4 data
# normalized by gC
plt_ana_ch4_gC <- inc_df2 %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative anaerobic C-CH4 respired (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_ch4_gC)

# plot first 3 months of ANAEROBIC C-CH4 data
# not normalized by gC, corrected for dips on days 40, 47, 54
plt_ana_ch4_corr <- inc_df2 %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative anaerobic C-CH4 respired", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_ch4_corr)

# plot first 3 months of ANAEROBIC C-CH4 data
# normalized by gC, corrected for dips on days 40, 47, 54
plt_ana_ch4_gC_corr <- inc_df2 %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative anaerobic C-CH4 respired (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_ana_ch4_gC_corr)

# plot 12 months of AVG. ANAEROBIC C-CH4 data using replicate values
# not normalized by gC
plt_avg_ana_ch4 <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CH4 respired - replicate averages", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_ch4)

# plot 12 months of AVG. ANAEROBIC C-CH4 data using replicate values
# normalized by gC
plt_avg_ana_ch4_gC <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CH4 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_ch4_gC)


# plot first 3 months of AVG. ANAEROBIC C-CH4 data using replicate values
# not normalized by gC, corrected for dips on days 40, 47, 54
plt_avg_ana_ch4_corr <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CH4 respired - replicate averages", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_ch4_corr)

# plot 3 months of AVG. ANAEROBIC C-CH4 data using replicate values
# normalized by gC, corrected for dips on days 40, 47, 54
plt_avg_ana_ch4_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative anaerobic C-CH4 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative anaerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_ana_ch4_gC_corr)


# --------  AEROBIC DATA: ACCUMULATED GAS IN JARS  --------

# --- AEROBIC CO2 ---

# plot 12 months of AEROBIC C-CO2 data
# not normalized by gC
plt_aer_co2 <- inc_df2 %>% 
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) + 
  geom_line() + 
  geom_point() +
  labs(title = "Cumulative aerobic C-CO2 respired", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_co2)

# plot 12 months of AEROBIC C-CO2 data
# normalized by gC
plt_aer_co2_gC <- inc_df2 %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative aerobic C-CO2 respired (normalized by g soil C)", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_co2_gC)

# plot first 3 months of AEROBIC C-CO2 data
# not normalized by gC
plt_aer_co2_corr <- inc_df2 %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative aerobic C-CO2 respired", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_co2_corr)

# plot first 3 months of AEROBIC C-CO2 data
# normalized by gC
plt_aer_co2_gC_corr <- inc_df2 %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative aerobic C-CO2 respired (normalized by g soil C)", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_co2_gC_corr)

# plot 12 months of AVG. AEROBIC C-CO2 data using replicate values
# not normalized by gC
plt_avg_aer_co2 <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CO2 respired - replicate averages", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_co2)

# plot 12 months of AVG. AEROBIC C-CO2 data using replicate values
# normalized by gC
plt_avg_aer_co2_gC <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CO2 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_co2_gC)


# plot first 3 months of AVG. AEROBIC C-CO2 data using replicate values
# not normalized by gC
plt_avg_aer_co2_corr <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99) %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CO2 respired - replicate averages", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_co2_corr)


# plot 3 months of AVG. AEROBIC C-CO2 data using replicate values, with shallowest vs. deepest depths highlighted
# shallowest depth is at 0.31-0.47m and deepest depth is at 19.83-19.98m
# not normalized by gC
# FYI - legends here are not updated

# shallow
color_lines_shal_31cm <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99 & sample_depth_lower_cm == 31)

# deep
color_lines_deep_1983cm <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99 & sample_depth_lower_cm == 1983)

# plot
plt_avg_aer_co2_corr_shal_deep <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99) %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line(color = "grey") + 
  geom_point(color = "grey") +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2, color = "grey") +
  labs(title = "Cumulative aerobic C-CO2 respired - replicate averages", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98")) +
  geom_line(mapping = NULL, data = color_lines_shal_31cm, color = col_pal[1], size = 0.7, show.legend = FALSE) +
  geom_line(mapping = NULL, data = color_lines_deep_1983cm, color = col_pal[12], size = 0.7, show.legend = FALSE)

print(plt_avg_aer_co2_corr_shal_deep)


# plot 3 months of AVG. AEROBIC C-CO2 data using replicate values
# normalized by gC
plt_avg_aer_co2_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CO2 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative aerobic C-CO2 (ugC-CO2/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_co2_gC_corr)


# --- AEROBIC CH4 ---

# plot 12 months of AEROBIC C-CH4 data
# not normalized by gC
plt_aer_ch4 <- inc_df2 %>% 
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) + 
  geom_line() + 
  geom_point() +
  labs(title = "Cumulative aerobic C-CH4 respired", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_ch4)

# plot 12 months of AEROBIC C-CH4 data
# normalized by gC
plt_aer_ch4_gC <- inc_df2 %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative aerobic C-CH4 respired (normalized by g soil C)", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_ch4_gC)

# plot first 3 months of AEROBIC C-CH4 data
# not normalized by gC
plt_aer_ch4_corr <- inc_df2 %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = accum_gas_ugC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative aerobic C-CH4 respired", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_ch4_corr)

# plot first 3 months of AEROBIC C-CH4 data
# normalized by gC
plt_aer_ch4_gC_corr <- inc_df2 %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, replicate))) +
  geom_line() +
  geom_point() +
  labs(title = "Cumulative aerobic C-CH4 respired (normalized by g soil C)", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_aer_ch4_gC_corr)

# plot 12 months of AVG. AEROBIC C-CH4 data using replicate values
# not normalized by gC
plt_avg_aer_ch4 <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CH4 respired - replicate averages", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_ch4)

# plot 12 months of AVG. AEROBIC C-CH4 data using replicate values
# normalized by gC
plt_avg_aer_ch4_gC <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CH4 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_ch4_gC)


# plot first 3 months of AVG. AEROBIC C-CH4 data using replicate values
# not normalized by gC
plt_avg_aer_ch4_corr <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic" & samp_int_day < 99) %>% 
  ggplot(aes(y = avg_accum_gas_ugC, x = samp_int_day, 
             color = sample_depth_range_m, linetype = factor(temp_treatment_C), 
             group = interaction(sample_depth_range_m, temp_treatment_C))) + 
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC - se_accum_gas_ugC, ymax = avg_accum_gas_ugC + se_accum_gas_ugC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CH4 respired - replicate averages", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_ch4_corr)

# plot 3 months of AVG. AEROBIC C-CH4 data using replicate values
# normalized by gC
plt_avg_aer_ch4_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = avg_accum_gas_ugC_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_accum_gas_ugC_gC - se_accum_gas_ugC_gC, ymax = avg_accum_gas_ugC_gC + se_accum_gas_ugC_gC), width = 0.2) +
  labs(title = "Cumulative aerobic C-CH4 respired - replicate averages (normalized by g soil C)", 
       y = "Cumulative aerobic C-CH4 (ugC-CH4/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_aer_ch4_gC_corr)


```

12. Create plots for respiration rates - anaerobic and aerobic plots (master's thesis)

```{r}
# can add  "+ facet_wrap(vars(depth_ID), ncol = 3)" to look at depths values individually

# --------  ANAEROBIC DATA: RESPIRATION RATES  --------

# plot 12 months of AVG. ANAEROBIC C-CO2 respiration rate (ugC-CO2/d/gC) data using replicate values
plt_avg_resp_rate_ana_CO2_d_gC <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic") %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Anaerobic C-CO2 respiration rate - replicate averages (normalized by g soil C)",
       y = "Anaerobic C-CO2 respiration rate (ugC-CO2/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_ana_CO2_d_gC)

# plot 3 months of AVG. ANAEROBIC C-CO2 respiration rate (ugC-CO2/d/gC) data using replicate values
# corrected for dips on days 40, 47, 54

plt_avg_resp_rate_ana_CO2_d_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Anaerobic C-CO2 respiration rate - replicate averages (normalized by g soil C)",
       y = "Anaerobic C-CO2 respiration rate (ugC-CO2/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_ana_CO2_d_gC_corr)

# plot 12 months of AVG. ANAEROBIC C-CH4 respiration rate (ugC-CH4/d/gC) data using replicate values
plt_avg_resp_rate_ana_CH4_d_gC <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic") %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Anaerobic C-CH4 respiration rate - replicate averages (normalized by g soil C)",
       y = "Anaerobic C-CH4 respiration rate (ugC-CH4/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_ana_CH4_d_gC)

# plot 3 months of AVG. ANAEROBIC C-CH4 respiration rate (ugC-CH4/d/gC) data using replicate values
# corrected for dips on days 40, 47, 54
plt_avg_resp_rate_ana_CH4_d_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "anaerobic" & 
           samp_int_day < 103 & samp_int_day != 40 & samp_int_day != 47 & samp_int_day != 54) %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Anaerobic C-CH4 respiration rate - replicate averages (normalized by g soil C)",
       y = "Anaerobic C-CH4 respiration rate (ugC-CH4/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_ana_CH4_d_gC_corr)


# --------  AEROBIC DATA: RESPIRATION RATES  --------

# plot 12 months of AVG. AEROBIC C-CO2 respiration rate (ugC-CO2/d/gC) data using replicate values
plt_avg_resp_rate_aer_CO2_d_gC <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic") %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Aerobic C-CO2 respiration rate - replicate averages (normalized by g soil C)",
       y = "Aerobic C-CO2 respiration rate (ugC-CO2/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_aer_CO2_d_gC)

# plot 3 months of AVG. AEROBIC C-CO2 respiration rate (ugC-CO2/d/gC) data using replicate values
plt_avg_resp_rate_aer_CO2_d_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CO2" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Aerobic C-CO2 respiration rate - replicate averages (normalized by g soil C)",
       y = "Aerobic C-CO2 respiration rate (ugC-CO2/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_aer_CO2_d_gC_corr)

# plot 12 months of AVG. AEROBIC C-CH4 respiration rate (ugC-CH4/d/gC) data using replicate values
plt_avg_resp_rate_aer_CH4_d_gC <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic") %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Aerobic C-CH4 respiration rate - replicate averages (normalized by g soil C)",
       y = "Aerobic C-CH4 respiration rate (ugC-CH4/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_aer_CH4_d_gC)

# plot 3 months of AVG. AEROBIC C-CH4 respiration rate (ugC-CH4/d/gC) data using replicate values
plt_avg_resp_rate_aer_CH4_d_gC_corr <- summ_vals %>%
  filter(gas_sampled == "CH4" & headspace_treatment == "aerobic" & samp_int_day < 99) %>%
  ggplot(aes(y = avg_resp_rate_ugC_d_gC, x = samp_int_day,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C),
             group = interaction(sample_depth_range_m, temp_treatment_C))) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = avg_resp_rate_ugC_d_gC - se_resp_rate_ugC_d_gC, 
                    ymax = avg_resp_rate_ugC_d_gC + se_resp_rate_ugC_d_gC), width = 0.2) +
  labs(title = "Aerobic C-CH4 respiration rate - replicate averages (normalized by g soil C)",
       y = "Aerobic C-CH4 respiration rate (ugC-CH4/d/gC)", x = "Sampling interval (days)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98"))
print(plt_avg_resp_rate_aer_CH4_d_gC_corr)

```


13. Create plots for total net C respiration as CO2e. Values will be averaged across the last three timepoints for the initial 3 month incubation period (master's thesis).
* C-CH4 will be converted to C-CO2 equivalents (C-CO2e) using a GWP of 28 (100 yr time scale, not including feedbacks) and then added to C-CO2 at each depth and replicate
* Replicate sets (1-3, 4-6, 7-9) will be averaged for the last three timepoints of the 3 month period
* Put all 4C data on one plot
* Put all 4C, 10C, 20C data on one plot (only for depths that had all three temperature treatments)

```{r}
# Make four new dfs from inc_df2, and add columns for CO2e to each [ e.g. C-CO2e = ugC-CH4 * 28 (GWP of CH4) ]. 

ana_co2_gwp <- inc_df2 %>%
  filter(headspace_treatment == "anaerobic" & gas_sampled == "CO2" & samp_int_day < 103 & samp_int_day > 68) %>% mutate(accum_gas_ugC_CO2e = accum_gas_ugC)

ana_ch4_gwp <- inc_df2 %>%
  filter(headspace_treatment == "anaerobic" & gas_sampled == "CH4" & samp_int_day < 103 & samp_int_day > 68) %>% mutate(accum_gas_ugC_CO2e = accum_gas_ugC * 28)

aer_co2_gwp <- inc_df2 %>%
  filter(headspace_treatment == "aerobic" & gas_sampled == "CO2" & samp_int_day < 99 & samp_int_day > 71) %>% mutate(accum_gas_ugC_CO2e = accum_gas_ugC)

aer_ch4_gwp <- inc_df2 %>%
  filter(headspace_treatment == "aerobic" & gas_sampled == "CH4" & samp_int_day < 99 & samp_int_day > 71) %>% mutate(accum_gas_ugC_CO2e = accum_gas_ugC * 28)

# Calculate total respiration in two summary dfs by adding ana C-CO2e (from ana_co2_gwp and ana_ch4_gwp) and aer C-CO2e (from aer_co2_gwp and aer_ch4_gwp). These summed values represent total C respired as C-CO2e for the final three timepoints of the first three months of incubations. 

ana_tot_resp <- ana_co2_gwp %>%
  mutate(total_resp_ugC_CO2e = accum_gas_ugC_CO2e + ana_ch4_gwp$accum_gas_ugC_CO2e)

aer_tot_resp <- aer_co2_gwp %>%
  mutate(total_resp_ugC_CO2e = accum_gas_ugC_CO2e + aer_ch4_gwp$accum_gas_ugC_CO2e)


# Group each total respiration df by depth_ID and replicate, and use summarise() to calculate the mean values for each individual replicate across the three final timepoints (rep 1, rep 2, etc.)
# Add empty columns to then calculate the averaged total respiration for each set of replicates (1-3, 4-6, 7-9)

ana_tot_resp <- ana_tot_resp %>%
  group_by(depth_ID, replicate) %>% 
  summarise(avg_total_resp_ugC_CO2e = mean(total_resp_ugC_CO2e)) %>%
  ungroup() %>%
  mutate(avg_rep_total_resp_ugC_CO2e = NA,
         se_rep_total_resp_ugC_CO2e = NA)

aer_tot_resp <- aer_tot_resp %>%
  group_by(depth_ID, replicate) %>% 
  summarise(avg_total_resp_ugC_CO2e = mean(total_resp_ugC_CO2e)) %>%
  ungroup() %>%
  mutate(avg_rep_total_resp_ugC_CO2e = NA,
         se_rep_total_resp_ugC_CO2e = NA)


# Calculate the mean and standard error values for each set of replicates (each individual replicate was averaged across the three final timepoints above)
# Unnecessary replicate rows were removed, remaining ones denote the beginning of the replicate set (replicate 1 remains for averaged 1-3 values, replicate 4 for averaged 4-6 values, replicate 7 remains for averaged 7-9 values)

for (i in 1:length(ana_tot_resp$avg_total_resp_ugC_CO2e)){
  if (ana_tot_resp$replicate[i] == 1 | ana_tot_resp$replicate[i] == 4 | ana_tot_resp$replicate[i] == 7){

    # average and find the standard error of each set of ana replicates (1-3, 4-6, 7-9)
    ana_tot_resp$avg_rep_total_resp_ugC_CO2e[i] <- mean(c(ana_tot_resp$avg_total_resp_ugC_CO2e[i], ana_tot_resp$avg_total_resp_ugC_CO2e[i+1], ana_tot_resp$avg_total_resp_ugC_CO2e[i+2]))
    ana_tot_resp$se_rep_total_resp_ugC_CO2e[i] <- sd(c(ana_tot_resp$avg_total_resp_ugC_CO2e[i], ana_tot_resp$avg_total_resp_ugC_CO2e[i+1], ana_tot_resp$avg_total_resp_ugC_CO2e[i+2])) / sqrt(3)
    }
  }

for (i in 1:length(aer_tot_resp$avg_total_resp_ugC_CO2e)){
  if (aer_tot_resp$replicate[i] == 1 | aer_tot_resp$replicate[i] == 4 | aer_tot_resp$replicate[i] == 7){

    # average and find the standard error of each set of aer replicates (1-3, 4-6, 7-9)
    aer_tot_resp$avg_rep_total_resp_ugC_CO2e[i] <- mean(c(aer_tot_resp$avg_total_resp_ugC_CO2e[i], aer_tot_resp$avg_total_resp_ugC_CO2e[i+1], aer_tot_resp$avg_total_resp_ugC_CO2e[i+2]))
    aer_tot_resp$se_rep_total_resp_ugC_CO2e[i] <- sd(c(aer_tot_resp$avg_total_resp_ugC_CO2e[i], aer_tot_resp$avg_total_resp_ugC_CO2e[i+1], aer_tot_resp$avg_total_resp_ugC_CO2e[i+2])) / sqrt(3)
    }
  }

# Remove NA values from the total respiration dfs
ana_tot_resp <- ana_tot_resp %>% 
  filter(!is.na(avg_rep_total_resp_ugC_CO2e))

aer_tot_resp <- aer_tot_resp %>% 
  filter(!is.na(avg_rep_total_resp_ugC_CO2e))

# Add columns back into these dfs for easier graphing, then combine ana and aer dfs
# Use distinct() to remove rows with repeating values, and select columns that represent the final analysis needed for graphing
tot_resp_3mo <- left_join(ana_tot_resp, ana_ch4_gwp) %>% 
  distinct(replicate, avg_total_resp_ugC_CO2e, .keep_all = TRUE) %>%
  select(depth_ID:temp_treatment_C, -avg_total_resp_ugC_CO2e)

tot_resp_aer <- left_join(aer_tot_resp, aer_ch4_gwp) %>% 
  distinct(replicate, avg_total_resp_ugC_CO2e, .keep_all = TRUE) %>%
  select(depth_ID:temp_treatment_C, -avg_total_resp_ugC_CO2e)

tot_resp_3mo <- full_join(tot_resp_3mo, tot_resp_aer)

# Create dot plots with standard error bars for total net C respiration as CO2e - two graphs for anaerobic (4C for all depths; 4C, 10C, 20C for 5 depths), two for aerobic (4C for all depths; 4C, 10C, 20C for 5 depths)
# use factor(levels =...) to organize the order of the x-axis
# use guides(... = ...) to get rid of specific components in the legends

# plot AVG. ANAEROBIC total respiration at 4C (ugC-CO2e) data using replicate values across last three timepoints of 3 month incubations
  
plt_avg_ana_tot_resp_4C <- tot_resp_3mo %>%
  filter(headspace_treatment == "anaerobic" & temp_treatment_C == 4) %>%
  mutate(sample_depth_range_m = factor(sample_depth_range_m, levels = c("0.31-0.47", 
                                                                        "0.6-0.76", 
                                                                        "1.1-1.17", 
                                                                        "3.05-3.21", 
                                                                        "5.24-5.39", 
                                                                        "7.21-7.35", 
                                                                        "10.05-10.2", 
                                                                        "12.62-12.77", 
                                                                        "13.65-13.8", 
                                                                        "16.63-16.78", 
                                                                        "18.52-18.67", 
                                                                        "19.83-19.98"))) %>%
  ggplot(aes(y = avg_rep_total_resp_ugC_CO2e, x = sample_depth_range_m,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C))) +
  geom_point() +
  geom_errorbar(aes(ymin = avg_rep_total_resp_ugC_CO2e - se_rep_total_resp_ugC_CO2e, 
                    ymax = avg_rep_total_resp_ugC_CO2e + se_rep_total_resp_ugC_CO2e), width = 0.2) +
  labs(title = "Total net anaerobic respiration (C-CO2e) - replicate averages at 4C",
       y = "Total net anaerobic respiration (ugC-CO2e)", x = "Depth (m)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98")) +
  guides(color = FALSE)
print(plt_avg_ana_tot_resp_4C)

# plot AVG. ANAEROBIC total respiration at 4C, 10C, 20C (ugC-CO2e) data using replicate values across last three timepoints of 3 month incubations
plt_avg_ana_tot_resp_all_temps <- tot_resp_3mo %>%
  filter(headspace_treatment == "anaerobic") %>%
  filter(sample_depth_lower_cm == 31 | sample_depth_lower_cm == 524 | sample_depth_lower_cm == 1005 | sample_depth_lower_cm == 1852 | sample_depth_lower_cm == 1983) %>%
  mutate(sample_depth_range_m = factor(sample_depth_range_m, levels = c("0.31-0.47", 
                                                                        "0.6-0.76", 
                                                                        "1.1-1.17", 
                                                                        "3.05-3.21", 
                                                                        "5.24-5.39", 
                                                                        "7.21-7.35", 
                                                                        "10.05-10.2", 
                                                                        "12.62-12.77", 
                                                                        "13.65-13.8", 
                                                                        "16.63-16.78", 
                                                                        "18.52-18.67", 
                                                                        "19.83-19.98"))) %>%
  ggplot(aes(y = avg_rep_total_resp_ugC_CO2e, x = sample_depth_range_m,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C))) +
  geom_point(position = position_dodge2(preserve = "single", width = 0.9)) +
  geom_errorbar(aes(ymin = avg_rep_total_resp_ugC_CO2e - se_rep_total_resp_ugC_CO2e,
                    ymax = avg_rep_total_resp_ugC_CO2e + se_rep_total_resp_ugC_CO2e), 
                width = 0.6, position = position_dodge(preserve = "single", width = 0.9)) +
  labs(title = "Total net anaerobic respiration (C-CO2e) - replicate averages at 4C, 10C, 20C",
       y = "Total net anaerobic respiration (ugC-CO2e)", x = "Depth (m)",
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47",
                                                    "0.6-0.76",
                                                    "1.1-1.17",
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98")) +
  guides(color = FALSE)
print(plt_avg_ana_tot_resp_all_temps)


# plot AVG. AEROBIC total respiration at 4C (ugC-CO2e) data using replicate values across last three timepoints of 3 month incubations
plt_avg_aer_tot_resp_4C <- tot_resp_3mo %>%
  filter(headspace_treatment == "aerobic" & temp_treatment_C == 4) %>%
  mutate(sample_depth_range_m = factor(sample_depth_range_m, levels = c("0.31-0.47", 
                                                                        "0.6-0.76", 
                                                                        "1.1-1.17", 
                                                                        "3.05-3.21", 
                                                                        "5.24-5.39", 
                                                                        "7.21-7.35", 
                                                                        "10.05-10.2", 
                                                                        "12.62-12.77", 
                                                                        "13.65-13.8", 
                                                                        "16.63-16.78", 
                                                                        "18.52-18.67", 
                                                                        "19.83-19.98"))) %>%
  ggplot(aes(y = avg_rep_total_resp_ugC_CO2e, x = sample_depth_range_m,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C))) +
  geom_point() +
  geom_errorbar(aes(ymin = avg_rep_total_resp_ugC_CO2e - se_rep_total_resp_ugC_CO2e, 
                    ymax = avg_rep_total_resp_ugC_CO2e + se_rep_total_resp_ugC_CO2e), width = 0.2) +
  labs(title = "Total net aerobic respiration (C-CO2e) - replicate averages at 4C",
       y = "Total net aerobic respiration (ugC-CO2e)", x = "Depth (m)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98")) +
  guides(color = FALSE)
print(plt_avg_aer_tot_resp_4C)

# plot AVG. AEROBIC total respiration at 4C, 10C, 20C (ugC-CO2e) data using replicate values across last three timepoints of 3 month incubations
plt_avg_aer_tot_resp_all_temps <- tot_resp_3mo %>%
  filter(headspace_treatment == "aerobic") %>%
  filter(sample_depth_lower_cm == 31 | sample_depth_lower_cm == 524 | sample_depth_lower_cm == 1005 | sample_depth_lower_cm == 1852 | sample_depth_lower_cm == 1983) %>%
  mutate(sample_depth_range_m = factor(sample_depth_range_m, levels = c("0.31-0.47", 
                                                                        "0.6-0.76", 
                                                                        "1.1-1.17", 
                                                                        "3.05-3.21", 
                                                                        "5.24-5.39", 
                                                                        "7.21-7.35", 
                                                                        "10.05-10.2", 
                                                                        "12.62-12.77", 
                                                                        "13.65-13.8", 
                                                                        "16.63-16.78", 
                                                                        "18.52-18.67", 
                                                                        "19.83-19.98"))) %>%
  ggplot(aes(y = avg_rep_total_resp_ugC_CO2e, x = sample_depth_range_m,
             color = sample_depth_range_m, linetype = factor(temp_treatment_C))) +
  geom_point(position = position_dodge2(preserve = "single", width = 0.9)) +
  geom_errorbar(aes(ymin = avg_rep_total_resp_ugC_CO2e - se_rep_total_resp_ugC_CO2e, 
                    ymax = avg_rep_total_resp_ugC_CO2e + se_rep_total_resp_ugC_CO2e), 
                width = 0.6, position = position_dodge(preserve = "single", width = 0.9)) +
  labs(title = "Total net aerobic respiration (C-CO2e) - replicate averages at 4C, 10C, 20C",
       y = "Total net aerobic respiration (ugC-CO2e)", x = "Depth (m)", 
       linetype = "Temperature treatment (C)", color = "Depth (m)") +
  scale_color_manual(values = col_pal, limits = c("0.31-0.47", 
                                                    "0.6-0.76", 
                                                    "1.1-1.17", 
                                                    "3.05-3.21",
                                                    "5.24-5.39",
                                                    "7.21-7.35",
                                                    "10.05-10.2",
                                                    "12.62-12.77",
                                                    "13.65-13.8",
                                                    "16.63-16.78",
                                                    "18.52-18.67",
                                                    "19.83-19.98")) +
  guides(color = FALSE)
print(plt_avg_aer_tot_resp_all_temps)

```


14. Save dataframes as .csv files and plots as .pdf files

```{r}

# Write dataframes to .csv files
# Update these with the current dates

write.csv(inc_df2, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Summary Tables/Calculated_Respiration_Rates_20201112.csv", row.names = FALSE) 

write.csv(summ_vals, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Summary Tables/Summarized_Respiration_Rates_20201112.csv", row.names = FALSE)


# Write 3-month plots to .png files - can also save as .pdf (or .jpeg?)
# Update these with the current dates

# --- ANA CO2 ---

# Cumulative CO2, normalized, corrected for dips in data (C-CO2/gC)
ggsave(plot = plt_ana_co2_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CO2_gC_3 months_20201112.png")

# Cumulative CO2 replicate averages, normalized, corrected for dips in data (C-CO2/gC)
ggsave(plot = plt_avg_ana_co2_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CO2 avgs_gC_3 months_20201112.png")

# Cumulative CO2, not normalized, corrected for dips in data (C-CO2)
ggsave(plot = plt_ana_co2_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CO2_3 months_20201112.png")

# Cumulative CO2 replicate averages, not normalized, corrected for dips in data (C-CO2)
ggsave(plot = plt_avg_ana_co2_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CO2 avgs_3 months_20201112.png")

# Cumulative CO2 replicate averages, shallow and deep highlighted, not normalized, corrected for dips in data (C-CO2)
ggsave(plot = plt_avg_ana_co2_corr_shal_deep, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CO2 avgs_shal_deep_3 months_20201112.png")

# --- ANA CH4 ---

# Cumulative CH4, normalized, corrected for dips in data (C-CH4/gC)
ggsave(plot = plt_ana_ch4_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CH4_gC_3 months_20201112.png")

# Cumulative CH4 replicate averages, normalized, corrected for dips in data (C-CH4/gC)
ggsave(plot = plt_avg_ana_ch4_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CH4 avgs_gC_3 months_20201112.png")

# Cumulative CH4, not normalized, corrected for dips in data (C-CH4)
ggsave(plot = plt_ana_ch4_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CH4_3 months_20201112.png")

# Cumulative CH4 replicate averages, not normalized, corrected for dips in data (C-CH4)
ggsave(plot = plt_avg_ana_ch4_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative ANA CH4 avgs_3 months_20201112.png")

# --- AER CO2 ---

# Cumulative CO2, normalized, corrected for dips in data (C-CO2/gC)
ggsave(plot = plt_aer_co2_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CO2_gC_3 months_20201112.png")

# Cumulative CO2 replicate averages, normalized, corrected for dips in data (C-CO2/gC)
ggsave(plot = plt_avg_aer_co2_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CO2 avgs_gC_3 months_20201112.png")

# Cumulative CO2, not normalized, corrected for dips in data (C-CO2)
ggsave(plot = plt_aer_co2_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CO2_3 months_20201112.png")

# Cumulative CO2 replicate averages, not normalized, corrected for dips in data (C-CO2)
ggsave(plot = plt_avg_aer_co2_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CO2 avgs_3 months_20201112.png")

# Cumulative CO2 replicate averages, shallow and deep highlighted, not normalized, corrected for dips in data (C-CO2)
ggsave(plot = plt_avg_aer_co2_corr_shal_deep, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CO2 avgs_shal_deep_3 months_20201112.png")

# --- AER CH4 ---

# Cumulative CH4, normalized, corrected for dips in data (C-CH4/gC)
ggsave(plot = plt_aer_ch4_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CH4_gC_3 months_20201112.png")

# Cumulative CH4 replicate averages, normalized, corrected for dips in data (C-CH4/gC)
ggsave(plot = plt_avg_aer_ch4_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CH4 avgs_gC_3 months_20201112.png")

# Cumulative CH4, not normalized, corrected for dips in data (C-CH4)
ggsave(plot = plt_aer_ch4_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CH4_3 months_20201112.png")

# Cumulative CH4 replicate averages, not normalized, corrected for dips in data (C-CH4)
ggsave(plot = plt_avg_aer_ch4_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Cumulative AER CH4 avgs_3 months_20201112.png")

# --- Respiration Rates ---

ggsave(plot = plt_avg_resp_rate_ana_CO2_d_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Avg resp rate ANA CO2_gC_3 months_20201112.png")

ggsave(plot = plt_avg_resp_rate_ana_CH4_d_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Avg resp rate ANA CH4_gC_3 months_20201112.png")

ggsave(plot = plt_avg_resp_rate_aer_CO2_d_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Avg resp rate AER CO2_gC_3 months_20201112.png")

ggsave(plot = plt_avg_resp_rate_aer_CH4_d_gC_corr, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Avg resp rate AER CH4_gC_3 months_20201112.png")

# --- Total Repiration ---

ggsave(plot = plt_avg_ana_tot_resp_4C, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Total resp ANA CO2e_4C_3 months_20201117.png")

ggsave(plot = plt_avg_ana_tot_resp_all_temps, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Total resp ANA CO2e_all temps_3 months_20201117.png")

ggsave(plot = plt_avg_aer_tot_resp_4C, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Total resp AER CO2e_4C_3 months_20201117.png")

ggsave(plot = plt_avg_aer_tot_resp_all_temps, "/Users/nancylf/Documents/UC Berkeley/Research/NGEE Arctic/NSF Goldstream Project/Incubations/Data Compilation/R Output_Graphs/Total resp AER CO2e_all temps_3 months_20201117.png")

```




